2024-06-14 11:58:36,083:create_spark_session:upload_to_s3:INFO:Spark session created successfully
2024-06-14 11:58:37,669:create_initial_dataframe:upload_to_s3:WARNING:Initial dataframe couldn't be created due to exception: Queries with streaming sources must be executed with writeStream.start();
kafka
2024-06-14 11:58:37,828:start_streaming:upload_to_s3:INFO:Streaming is being started...
2024-06-14 11:58:38,944:close:upload_to_s3:INFO:Closing down clientserver connection
2024-06-14 11:59:15,456:decorated_func:clean_data:INFO:calling get_users with arguments ('https://randomuser.me/api/?results=1',)
return value: {'gender': 'female', 'name': {'title': 'Ms', 'first': 'Dora', 'last': 'Radanović'}, 'location': {'street': {'number': 662, 'name': 'Jovana Andrejevića '}, 'city': 'Knjaževac', 'state': 'Srem', 'country': 'Serbia', 'postcode': 52678, 'coordinates': {'latitude': '60.2084', 'longitude': '16.8832'}, 'timezone': {'offset': '-10:00', 'description': 'Hawaii'}}, 'email': 'dora.radanovic@example.com', 'login': {'uuid': '39c1155d-7f4a-40b1-8efd-5ae60cb9c92b', 'username': 'ticklishfrog693', 'password': 'vernon', 'salt': '0sNbTeb3', 'md5': '02f7265e083d47493502116b44f3a6ac', 'sha1': 'af2711d67ad17092fd2d05ea5948dd86a08f7ec4', 'sha256': '582f574324e3595443db450bdd3026f90cca654d281fd013c749b1bd84294bdb'}, 'dob': {'date': '1994-11-02T16:16:38.146Z', 'age': 29}, 'registered': {'date': '2010-05-01T17:34:43.294Z', 'age': 14}, 'phone': '037-5751-775', 'cell': '062-6728-687', 'id': {'name': 'SID', 'value': '283190123'}, 'picture': {'large': 'https://randomuser.me/api/portraits/women/4.jpg', 'medium': 'https://randomuser.me/api/portraits/med/women/4.jpg', 'thumbnail': 'https://randomuser.me/api/portraits/thumb/women/4.jpg'}, 'nat': 'RS'}
2024-06-14 11:59:15,456:decorated_func:clean_data:INFO:calling clean_data with arguments ({'gender': 'female', 'name': {'title': 'Ms', 'first': 'Dora', 'last': 'Radanović'}, 'location': {'street': {'number': 662, 'name': 'Jovana Andrejevića '}, 'city': 'Knjaževac', 'state': 'Srem', 'country': 'Serbia', 'postcode': 52678, 'coordinates': {'latitude': '60.2084', 'longitude': '16.8832'}, 'timezone': {'offset': '-10:00', 'description': 'Hawaii'}}, 'email': 'dora.radanovic@example.com', 'login': {'uuid': '39c1155d-7f4a-40b1-8efd-5ae60cb9c92b', 'username': 'ticklishfrog693', 'password': 'vernon', 'salt': '0sNbTeb3', 'md5': '02f7265e083d47493502116b44f3a6ac', 'sha1': 'af2711d67ad17092fd2d05ea5948dd86a08f7ec4', 'sha256': '582f574324e3595443db450bdd3026f90cca654d281fd013c749b1bd84294bdb'}, 'dob': {'date': '1994-11-02T16:16:38.146Z', 'age': 29}, 'registered': {'date': '2010-05-01T17:34:43.294Z', 'age': 14}, 'phone': '037-5751-775', 'cell': '062-6728-687', 'id': {'name': 'SID', 'value': '283190123'}, 'picture': {'large': 'https://randomuser.me/api/portraits/women/4.jpg', 'medium': 'https://randomuser.me/api/portraits/med/women/4.jpg', 'thumbnail': 'https://randomuser.me/api/portraits/thumb/women/4.jpg'}, 'nat': 'RS'},)
return value: {'full_name': 'Dora Radanović', 'country': 'Serbia', 'email': 'dora.radanovic@example.com', 'gender': 'female', 'city': 'Knjaževac'}
2024-06-14 11:59:21,350:decorated_func:clean_data:INFO:calling get_users with arguments ('https://randomuser.me/api/?results=1',)
return value: {'gender': 'female', 'name': {'title': 'Miss', 'first': 'Sedef', 'last': 'Pekkan'}, 'location': {'street': {'number': 955, 'name': 'Anafartalar Cd'}, 'city': 'Malatya', 'state': 'Samsun', 'country': 'Turkey', 'postcode': 35467, 'coordinates': {'latitude': '67.5891', 'longitude': '108.2919'}, 'timezone': {'offset': '+8:00', 'description': 'Beijing, Perth, Singapore, Hong Kong'}}, 'email': 'sedef.pekkan@example.com', 'login': {'uuid': 'ea3d118a-411b-41d6-911b-90eeb29859db', 'username': 'sadlion147', 'password': 'alatam', 'salt': 'geTe1zve', 'md5': '984524e57135bc346d0fbc7c237aaf99', 'sha1': 'ab67bf5bf0d1f9aa40fb7d790e0341c0fe5c0dde', 'sha256': '98c7a516a55a69300c844c5011dca283e79a338498b7a1894100eb5d1dabcc48'}, 'dob': {'date': '1997-01-22T15:10:06.943Z', 'age': 27}, 'registered': {'date': '2020-08-19T05:25:30.511Z', 'age': 3}, 'phone': '(155)-368-7141', 'cell': '(404)-197-9024', 'id': {'name': '', 'value': None}, 'picture': {'large': 'https://randomuser.me/api/portraits/women/69.jpg', 'medium': 'https://randomuser.me/api/portraits/med/women/69.jpg', 'thumbnail': 'https://randomuser.me/api/portraits/thumb/women/69.jpg'}, 'nat': 'TR'}
2024-06-14 11:59:21,350:decorated_func:clean_data:INFO:calling clean_data with arguments ({'gender': 'female', 'name': {'title': 'Miss', 'first': 'Sedef', 'last': 'Pekkan'}, 'location': {'street': {'number': 955, 'name': 'Anafartalar Cd'}, 'city': 'Malatya', 'state': 'Samsun', 'country': 'Turkey', 'postcode': 35467, 'coordinates': {'latitude': '67.5891', 'longitude': '108.2919'}, 'timezone': {'offset': '+8:00', 'description': 'Beijing, Perth, Singapore, Hong Kong'}}, 'email': 'sedef.pekkan@example.com', 'login': {'uuid': 'ea3d118a-411b-41d6-911b-90eeb29859db', 'username': 'sadlion147', 'password': 'alatam', 'salt': 'geTe1zve', 'md5': '984524e57135bc346d0fbc7c237aaf99', 'sha1': 'ab67bf5bf0d1f9aa40fb7d790e0341c0fe5c0dde', 'sha256': '98c7a516a55a69300c844c5011dca283e79a338498b7a1894100eb5d1dabcc48'}, 'dob': {'date': '1997-01-22T15:10:06.943Z', 'age': 27}, 'registered': {'date': '2020-08-19T05:25:30.511Z', 'age': 3}, 'phone': '(155)-368-7141', 'cell': '(404)-197-9024', 'id': {'name': '', 'value': None}, 'picture': {'large': 'https://randomuser.me/api/portraits/women/69.jpg', 'medium': 'https://randomuser.me/api/portraits/med/women/69.jpg', 'thumbnail': 'https://randomuser.me/api/portraits/thumb/women/69.jpg'}, 'nat': 'TR'},)
return value: {'full_name': 'Sedef Pekkan', 'country': 'Turkey', 'email': 'sedef.pekkan@example.com', 'gender': 'female', 'city': 'Malatya'}
2024-06-14 11:59:26,918:decorated_func:clean_data:INFO:calling get_users with arguments ('https://randomuser.me/api/?results=1',)
return value: {'gender': 'female', 'name': {'title': 'Miss', 'first': 'Frida', 'last': 'Madsen'}, 'location': {'street': {'number': 7203, 'name': 'Nordre Strandvej'}, 'city': 'Agerbæk', 'state': 'Nordjylland', 'country': 'Denmark', 'postcode': 22481, 'coordinates': {'latitude': '-39.1742', 'longitude': '85.4828'}, 'timezone': {'offset': '-1:00', 'description': 'Azores, Cape Verde Islands'}}, 'email': 'frida.madsen@example.com', 'login': {'uuid': '5736b909-297f-45dd-971b-9f461f769c0d', 'username': 'sadmeercat995', 'password': 'annmarie', 'salt': 'MD7t21KB', 'md5': '1988c85e662d305d26ffa17722caa956', 'sha1': '057a25b2117a1d717686e2b298b379d04f4c3589', 'sha256': '4086dbeedea21d2eac21d1f93d404a815f02a7a24af5a9dc5f2472a419f15455'}, 'dob': {'date': '1962-04-10T22:29:57.202Z', 'age': 62}, 'registered': {'date': '2010-07-28T17:44:51.908Z', 'age': 13}, 'phone': '94357080', 'cell': '65195545', 'id': {'name': 'CPR', 'value': '100462-7928'}, 'picture': {'large': 'https://randomuser.me/api/portraits/women/6.jpg', 'medium': 'https://randomuser.me/api/portraits/med/women/6.jpg', 'thumbnail': 'https://randomuser.me/api/portraits/thumb/women/6.jpg'}, 'nat': 'DK'}
2024-06-14 11:59:26,918:decorated_func:clean_data:INFO:calling clean_data with arguments ({'gender': 'female', 'name': {'title': 'Miss', 'first': 'Frida', 'last': 'Madsen'}, 'location': {'street': {'number': 7203, 'name': 'Nordre Strandvej'}, 'city': 'Agerbæk', 'state': 'Nordjylland', 'country': 'Denmark', 'postcode': 22481, 'coordinates': {'latitude': '-39.1742', 'longitude': '85.4828'}, 'timezone': {'offset': '-1:00', 'description': 'Azores, Cape Verde Islands'}}, 'email': 'frida.madsen@example.com', 'login': {'uuid': '5736b909-297f-45dd-971b-9f461f769c0d', 'username': 'sadmeercat995', 'password': 'annmarie', 'salt': 'MD7t21KB', 'md5': '1988c85e662d305d26ffa17722caa956', 'sha1': '057a25b2117a1d717686e2b298b379d04f4c3589', 'sha256': '4086dbeedea21d2eac21d1f93d404a815f02a7a24af5a9dc5f2472a419f15455'}, 'dob': {'date': '1962-04-10T22:29:57.202Z', 'age': 62}, 'registered': {'date': '2010-07-28T17:44:51.908Z', 'age': 13}, 'phone': '94357080', 'cell': '65195545', 'id': {'name': 'CPR', 'value': '100462-7928'}, 'picture': {'large': 'https://randomuser.me/api/portraits/women/6.jpg', 'medium': 'https://randomuser.me/api/portraits/med/women/6.jpg', 'thumbnail': 'https://randomuser.me/api/portraits/thumb/women/6.jpg'}, 'nat': 'DK'},)
return value: {'full_name': 'Frida Madsen', 'country': 'Denmark', 'email': 'frida.madsen@example.com', 'gender': 'female', 'city': 'Agerbæk'}
